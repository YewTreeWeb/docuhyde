{%- if page.url == "/" -%}
{%- assign pageName = 'home' -%}
{%- else -%}
{%- assign pageName = page.title -%}
{%- endif -%}

<!DOCTYPE html>
<html lang="{{ site.lang | default: 'en-GB' }}">

{%- include head.html -%}

<body
  class="layout-{{ page.layout | default: layout.layout }}{% if page.classes or layout.classes %}{{ page.classes | default: layout.classes | join: ' ' | prepend: ' ' }}{% endif %} page-{{ pageName | slugify }} is-loading"
  data-theme="light">

  <!--[if lte IE 9]>
      <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
    <![endif]-->
  {%- include_cached skip-links.html -%}

  {%- include header.html -%}

  <main class="layout-{{ page.layout | default: layout.layout }} wrapper site-content">
    {{ content }}
  </main>

  {%- include_cached footer.html -%}

  <!-- JS -->
  {%- if jekyll.environment == "production" -%}
    <!-- Google Analytics: change UA-XXXXX-Y to be your site's ID. -->
    <script>
      window.ga = function () {
        ga.q.push(arguments)
      };
      ga.q = [];
      ga.l = +new Date;
      ga('create', '{{ site.google_analytics }}', 'auto');
      ga('send', 'pageview')
    </script>
    <script src="https://www.google-analytics.com/analytics.js" async defer></script>
  {%- endif -%}

  {%- comment -%} Firebase {%- endcomment -%}
  {%- if site.firebase_projectID -%}
    <!-- The core Firebase JS SDK is always required and must be listed first -->
    <script src="https://www.gstatic.com/firebasejs/{{ site.firebase_v | default: '7.15.1' }}/firebase-app.js"></script>
    <script src="https://www.gstatic.com/firebasejs/{{ site.firebase_v | default: '7.15.1' }}/firebase-firestore.js"></script>

    <!-- TODO: Add SDKs for Firebase products that you want to use
        https://firebase.google.com/docs/web/setup#available-libraries -->
    <script src="https://www.gstatic.com/firebasejs/{{ site.firebase_v | default: '7.15.1' }}/firebase-analytics.js"></script>

    <script>
      // Your web app's Firebase configuration
      var firebaseConfig = {
        apiKey: "{{ site.firebase_apiKey }}",
        authDomain: "{{ site.firebase_projectID | append: '.firebaseapp.com' }}",
        databaseURL: "{{ site.firebase_projectID | prepend: 'https://' | append: '.firebaseio.com' }}",
        projectId: "{{ site.firebase_projectID }}",
        storageBucket: "{{ site.firebase_project | append: '.appspot.com' }}",
        messagingSenderId: "{{ site.firebase_messagingID }}",
        appId: "{{ site.firebase_appID }}",
        measurementId: "{{ site.firebase_measurementID }}"
      };
      // Initialize Firebase
      firebase.initializeApp(firebaseConfig);
      firebase.analytics();
      var db = firebase.firestore();
    </script>
  {%- endif -%}
  {%- comment -%} End Firebase {%- endcomment -%}

  {%- comment -%} Hybrid Lasyloading {%- endcomment -%}
  <script type="module">
    {%- if jekyll.environment == "production" -%}
      (async()=>{if("loading"in HTMLImageElement.prototype){const e=document.querySelectorAll("img.lazyload");e.forEach(e=>{e.src=e.dataset.src}),document.addEventListener("DOMContentLoaded",function(){const s=new IntersectionObserver((e,s)=>{e.forEach(e=>{if(e.isIntersecting){const t=e.target;t.classList.add("lazyloaded"),s.unobserve(t)}})});e.forEach(e=>{s.observe(e)})})}else{await import("{{ '/assets/js/ls.unveilhooks.min.js' | relative_url }}"),await import("{{ '/assets/js/blur-up/ls.blur-up.min.js' | relative_url }}"),await import("{{ '/assets/js/lazysizes.min.js' | relative_url }}");lazySizes.init()}})();
    {%- else -%}
      (async () => {
        if ('loading' in HTMLImageElement.prototype) {
          const images = document.querySelectorAll("img.lazyload");
          images.forEach(img => {
            img.src = img.dataset.src;
          });
          document.addEventListener("DOMContentLoaded", function() {
            const imageObserver = new IntersectionObserver((entries, imgObserver) => {
              entries.forEach((entry) => {
                if (entry.isIntersecting) {
                  const lazyImage = entry.target
                  console.log("lazy loading ", lazyImage)
                  lazyImage.classList.add('lazyloaded')
                  imgObserver.unobserve(lazyImage)
                }
              })
            });
            images.forEach((v) => {
              imageObserver.observe(v);
            })
          });
        } else {
          // Dynamically import the LazySizes library
          const lazySizesPluginUnveil = await import("{{ '/assets/js/ls.unveilhooks.min.js' | relative_url }}")
          const lazySizesPluginBlur = await import("{{ '/assets/js/blur-up/ls.blur-up.min.js' | relative_url }}")
          const lazySizesLib = await import("{{ '/assets/js/lazysizes.min.js' | relative_url }}");
          // Initiate LazySizes (reads data-src & class=lazyload)
          lazySizes.init(); // lazySizes works off a global.
        }
      })();
    {%- endif -%}
  </script>
  <script nomodule>
    "use strict";function _getRequireWildcardCache(){if("function"!=typeof WeakMap)return null;var e=new WeakMap;return _getRequireWildcardCache=function(){return e},e}function _interopRequireWildcard(e){if(e&&e.__esModule)return e;if(null===e||"object"!=typeof e&&"function"!=typeof e)return{default:e};var r=_getRequireWildcardCache();if(r&&r.has(e))return r.get(e);var t={},i=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var n in e)if(Object.prototype.hasOwnProperty.call(e,n)){var a=i?Object.getOwnPropertyDescriptor(e,n):null;a&&(a.get||a.set)?Object.defineProperty(t,n,a):t[n]=e[n]}return t.default=e,r&&r.set(e,t),t}(async()=>{if("loading"in HTMLImageElement.prototype){const e=document.querySelectorAll("img.lazyload");e.forEach(e=>{e.src=e.dataset.src}),document.addEventListener("DOMContentLoaded",function(){const r=new IntersectionObserver((e,r)=>{e.forEach(e=>{if(e.isIntersecting){const t=e.target;t.classList.add("lazyloaded"),r.unobserve(t)}})});e.forEach(e=>{r.observe(e)})})}else{await Promise.resolve().then(()=>_interopRequireWildcard(require("{{ '/assets/js/ls.unveilhooks.min.js' | relative_url }}"))),await Promise.resolve().then(()=>_interopRequireWildcard(require("{{ '/assets/js/blur-up/ls.blur-up.min.js' | relative_url }}"))),await Promise.resolve().then(()=>_interopRequireWildcard(require("{{ '/assets/js/lazysizes.min.js' | relative_url }}")));lazySizes.init()}})();
  </script>

  {%- comment -%} External JS {%- endcomment -%}
  <script src="{{ '/assets/js/breakpoints.min.js' | relative_url }}" defer></script>
  <script src="{{ '/assets/js/browser.min.js' | relative_url }}" defer></script>
  <script src="{{ '/assets/js/runtime.js' | relative_url }}" defer></script>
  <script src="{{ '/assets/js/vendors.bundle.js' | relative_url }}" defer></script>
  <script src="{{ '/assets/js/main.bundle.js' | relative_url }}" defer></script>
  <script src="//instant.page/5.1.0" type="module" integrity="sha384-by67kQnR+pyfy8yWP4kPO12fHKRLHZPfEsiSXR8u2IKcTdxD805MGUXBzVPnkLHw"></script>
</body>

</html>
